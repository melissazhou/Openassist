# 06 数据质量规则引擎

## 规则类型

| 类型 | 说明 | 示例 |
|---|---|---|
| **required** | 必填校验 | Item Description 不能为空 |
| **format** | 格式校验(正则) | Item Code 必须 `^[A-Z0-9]{3}-\d{4,6}$` |
| **range** | 范围校验 | Unit Cost > 0 |
| **length** | 长度校验 | Description ≤ 240字符 (EBS限制) |
| **lookup** | 参照校验 | UOM必须在标准UOM列表中 |
| **uniqueness** | 唯一性 | Item Code 不能重复 |
| **crossfield** | 字段联动 | 如果Category=原材料, 则Lead Time必填 |
| **custom** | 自定义SQL/JS | 自由编写校验逻辑 |

## 规则配置示例

```json
{
  "name": "Item Code格式校验",
  "entityType": "item",
  "fieldName": "item_code",
  "ruleType": "format",
  "ruleConfig": {
    "pattern": "^[A-Z0-9]{3}-\\d{4,6}$",
    "message": "Item Code格式必须为 XXX-0000 (3位字母数字-4到6位数字)"
  },
  "severity": "ERROR"
}
```

## 执行时机

1. **实时校验** — 用户填写表单时即时反馈
2. **提交校验** — 提交审批前强制通过所有ERROR级规则
3. **定时批量检查** — 每日检查存量数据质量
4. **导入校验** — Excel批量导入时逐行检查

## 数据质量仪表板

- 整体质量评分 (通过率%)
- 按字段/规则/严重级别的错误分布
- 质量趋势图 (周/月)
- Top 10 问题数据
